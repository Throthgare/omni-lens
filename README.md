# OmniLens

[![PyPI version](https://badge.fury.io/py/omnilens.svg)](https://pypi.org/project/omnilens/)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

![OmniLens Report Preview](samples/sample_report.html)

*View the interactive HTML report at [samples/sample_report.html](samples/sample_report.html)*

OmniLens is a professional-grade code analysis tool that provides comprehensive insights into your codebase. It analyzes git repositories and generates detailed reports on code quality, complexity, technical debt, and more.

## Sample Report

Check out the [samples/](samples/) folder to see example reports generated by OmniLens, including an interactive HTML report with charts and metrics.

## Features

- **Git Repository Analysis**: Deep analysis of commit history, authors, and changes
- **Code Metrics**: Cyclomatic complexity, maintainability index, and technical debt calculation
- **Multi-Language Support**: Supports 80+ programming languages with syntax-aware parsing
- **Tree-Sitter Integration**: Accurate AST parsing for precise class/function detection
- **Interactive Reports**: HTML reports with interactive charts and visualizations
- **CSV Export**: Export commits and classes data for further analysis
- **Dependency Graph**: Extract and visualize code dependencies
- **Branch Comparison**: Compare different branches or commits
- **Progress Tracking**: Real-time progress bars for large repositories
- **Configurable**: Extensive configuration options and exclude patterns

## Installation

### From PyPI
```bash
pip install omnilens
```

### From Source
```bash
git clone https://github.com/Throthgare/omni-lens.git
cd omni-lens
pip install .
```

## Usage

### Basic Usage
```bash
# Analyze current directory
omnilens

# Analyze specific repository
omnilens /path/to/repo

# Generate HTML report
omnilens --format html --output report.html

# Analyze with tech debt metrics
omnilens --tech-debt --complexity
```

**Note:** OmniLens automatically detects whether you're in a git repository. If no git repo is found, it automatically enables `--no-git` mode and analyzes files directly.

### Advanced Examples
```bash
# Filter by date and author
omnilens --since "2 weeks ago" --author "John Doe"

# Export data to CSV
omnilens --export-csv commits.csv --export-classes-csv classes.csv

# Compare branches
omnilens --diff main..feature

# Interactive mode
omnilens --interactive

# Dependency analysis
omnilens --deps --format html
```

## Command Line Options

| Option | Description |
|--------|-------------|
| `path` | Path to repository (default: current directory) |
| `--since DATE` | Start date for analysis (e.g., '2023-01-01' or '2 weeks ago') |
| `--until DATE` | End date for analysis (e.g., 'yesterday') |
| `--author PATTERN` | Filter commits by author (supports regex) |
| `--output FILE` | Output file path (default: intelligence_report.json) |
| `--format FORMAT` | Output format: json, markdown, html, csv (default: json) |
| `--verbose, -v` | Enable verbose output |
| `--no-loc` | Skip LOC counting (faster) |
| `--no-git` | Skip git analysis (auto-detected if no git repo) |
| `--no-classes` | Skip class extraction |
| `--all` | Include merge commits (default excludes them) |
| `--snip-format FORMAT` | Code snippet format: short (1-20 lines) or long (10-50 lines) |
| `--deep-level LEVEL` | Depth of file analysis: 1=basic, 2=detailed, 3=comprehensive, all=maximum |
| `--progress` | Show progress bar for large repos |
| `--export-csv FILE` | Export commits to CSV file |
| `--export-classes-csv FILE` | Export classes to CSV file |
| `--tech-debt` | Calculate technical debt metrics |
| `--complexity` | Calculate complexity metrics |
| `--html` | Generate HTML report (shorthand for --format html) |
| `--interactive` | Run in interactive TUI mode |
| `--config FILE` | Path to config file (YAML) |
| `--diff BRANCH` | Compare with specified branch (e.g., 'main..feature') |
| `--exclude-dirs PATS` | Comma-separated directories to exclude |
| `--exclude-files PATS` | Comma-separated files to exclude |
| `--deps` | Extract dependency graph |
| `--ai-summary` | Generate AI summary (requires OpenAI key) |
| `--no-cache` | Disable caching |
| `--tree-sitter` | Force Tree-Sitter parsing (default: auto) |
| `--version` | Show version number |

## Output Formats

### JSON (Default)
Structured data for programmatic use.

### Markdown
Human-readable summary report.

### HTML
Interactive web report with charts and visualizations.

### CSV
Tabular data for spreadsheet analysis.

## Sample Report

```
OmniLens Report

## Overview
- Path: /path/to/repo
- Analyzed At: 2024-01-11T12:00:00
- Total Files: 150
- Lines of Code: 12500
- Git Repository: Yes

## Code Elements
- Classes: 45
- Functions: 320
- Languages: Python (60%), JavaScript (25%), Go (15%)

## Commit History
- Total Commits: 250
- Contributors: 8
- Most Active: John Doe (120 commits)

## Code Quality
- Cyclomatic Complexity: 2.3 (avg)
- Technical Debt: Low
- Maintainability Index: 78/100
```

## Requirements

- Python 3.8+
- Git (for repository analysis)

## The OmniSuite Vision

OmniLens is part of the emerging OmniSuite for developers:

- **OmniLens**: Analyze and predict - Find code hotspots before they become bugs
- **OmniRun**: Execute and fix - Run code with intelligent error correction
- **OmniBuild**: Deploy and scale - Smart CI/CD with predictive optimization

*Coming soon - follow for updates!*

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Support

If you find this tool useful, please consider starring the repository on GitHub!

For issues and questions, please open an issue on the [GitHub repository](https://github.com/Throthgare/omni-lens/issues).